{"pageProps":{"cmsData":{"settings":{"darkMode":{"defaultMode":"light","overrideOS":true},"nextImages":{"feature":true,"inline":true,"quality":80,"source":false},"rssFeed":true,"toc":{"enable":true,"maxDepth":2},"commenting":{"system":"giscus","disqusShortname":"","giscusConfig":{"repo":"roninro/blog","repoId":"MDEwOlJlcG9zaXRvcnkzMDkyNTUzODI","category":"Comments","categoryId":"DIC_kwDOEm7c1s4B_sst","mapping":"pathname","emitMetadata":false,"reactionsEnabled":true}},"siteUrl":"https://fninit.com","title":"RoninRo's Blog","description":"Thoughts, stories and ideas.","logo":"/images/logo.png","cover_image":"","facebook":"","twitter":"","lang":"en","navigation":[{"label":"Home","url":"/"},{"label":"About","url":"/about/"}],"secondary_navigation":[],"logoImage":{"url":"/images/logo.png","dimensions":{"width":500,"height":405}}},"post":{"slug":"/posts/2017/ios-KVOController","title":"KVO & KVOController","date":"2017-06-30T03:08:26.000Z","excerpt":null,"draft":false,"page":false,"comment":true,"featureImage":{"url":"/images/wOZ0yyfTV5w-unsplash.jpg","dimensions":{"width":2000,"height":1333}},"toc":null,"tags":[{"name":"KVOController","slug":"kvocontroller","count":1},{"name":"iOS","slug":"ios"}],"authors":[{"slug":"roninro","name":"Roninro","cover_image":"/images/publication-cover.png","profileImage":{"url":"/images/avatar.jpg","dimensions":{"width":1080,"height":1080}},"location":"THE INTERNET","bio":"Software Development Engineer","twitter":"@xxxxx","facebook":"xxxxxx"}],"primary_tag":{"name":"KVOController","slug":"kvocontroller","count":1},"reading_time":"8 min read","mdxSource":"var Component=(()=>{var d=Object.create;var o=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var t=a=>o(a,\"__esModule\",{value:!0});var k=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),b=(a,s)=>{for(var c in s)o(a,c,{get:s[c],enumerable:!0})},i=(a,s,c,e)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let l of m(s))!N.call(a,l)&&(c||l!==\"default\")&&o(a,l,{get:()=>s[l],enumerable:!(e=h(s,l))||e.enumerable});return a},f=(a,s)=>i(t(o(a!=null?d(u(a)):{},\"default\",!s&&a&&a.__esModule?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a),g=(a=>(s,c)=>a&&a.get(s)||(c=i(t({}),s,1),a&&a.set(s,c),c))(typeof WeakMap!=\"undefined\"?new WeakMap:0);var p=k((V,r)=>{r.exports=_jsx_runtime});var v={};b(v,{default:()=>_,frontmatter:()=>O});var n=f(p()),O={categories:[\"iOS\"],date:\"2017-06-30T11:08:26+08:00\",tags:[\"KVOController\",\"iOS\"],title:\"KVO & KVOController\",authors:[\"Roninro\"],feature_image:\"/images/wOZ0yyfTV5w-unsplash.jpg\"};function y(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h3:\"h3\",a:\"a\",span:\"span\",p:\"p\",pre:\"pre\",code:\"code\",h4:\"h4\",ul:\"ul\",li:\"li\",ol:\"ol\",strong:\"strong\",em:\"em\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h3,{id:\"kvo\\u7684\\u5B9E\\u73B0\\u673A\\u5236\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#kvo\\u7684\\u5B9E\\u73B0\\u673A\\u5236\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"KVO\\u7684\\u5B9E\\u73B0\\u673A\\u5236\"]}),`\n`,(0,n.jsxs)(e.p,{children:[`KVO \\u662F Objective-C \\u5BF9\\u89C2\\u5BDF\\u8005\\u6A21\\u5F0F\\u7684\\u5B9E\\u73B0\\u3002\\u4ECE\\u82F9\\u679C\\u7684\n`,(0,n.jsx)(e.a,{href:\"https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/KeyValueObserving/Articles/KVOImplementation.html\",children:\"\\u6587\\u6863\"}),`\n\\u4E2D\\u5BF9\\u4E8E\\u5B83\\u7684\\u5B9E\\u73B0\\u63CF\\u8FF0\\u53EF\\u4EE5\\u77E5\\u9053\\uFF1A KVO \\u662F\\u901A\\u8FC7 isa-swizzling \\u5B9E\\u73B0\\u7684\\u3002\n\\u5F53\\u4F60\\u89C2\\u5BDF\\u4E00\\u4E2A\\u5BF9\\u8C61\\u65F6\\uFF0C\\u8BE5\\u5BF9\\u8C61\\u7684isa\\u6307\\u9488\\u88AB\\u4FEE\\u6539\\uFF0C\\u6307\\u5411\\u4E00\\u4E2A\\u4E2D\\u95F4\\u7C7B\\uFF0C\\u800C\\u4E0D\\u662F\\u5176\\u771F\\u5B9E\\u7684\\u7C7B\\u3002\\u4F46\\u662F\\u5177\\u4F53\\u7684\\u5B9E\\u73B0\\u82F9\\u679C\\u7684\\u6587\\u6863\\u91CC\\u5E76\\u6CA1\\u6709\\u8BE6\\u7EC6\\u8BF4\\u660E\\u3002`]}),`\n`,(0,n.jsx)(e.p,{children:\"\\u4E8B\\u5B9E\\u4E0A\\uFF0C\\u8FD9\\u4E2A\\u4E2D\\u95F4\\u7C7B\\u4F1A\\u5728\\u5BF9\\u8C61\\u88AB\\u89C2\\u5BDF\\u65F6\\u52A8\\u6001\\u5730\\u88AB\\u521B\\u5EFA\\u3002\\u7EE7\\u627F\\u81EA\\u8BE5\\u5BF9\\u8C61\\u539F\\u6765\\u7684\\u7C7B\\uFF0C\\u5E76\\u4E14\\u91CD\\u5199\\u88AB\\u89C2\\u5BDF\\u5C5E\\u6027\\u7684 setter \\u65B9\\u6CD5\\u3002\\u91CD\\u5199\\u7684\\u65B9\\u6CD5\\u8D1F\\u8D23\\u5728\\u8C03\\u7528\\u539F setter \\u65B9\\u6CD5\\u4E4B\\u524D\\u548C\\u4E4B\\u540E\\uFF0C\\u901A\\u77E5\\u6240\\u6709\\u89C2\\u5BDF\\u5BF9\\u8C61\\u503C\\u7684\\u66F4\\u6539\\u3002\\u7136\\u540E\\u5C06 isa \\u6307\\u9488\\u6307\\u5411\\u65B0\\u521B\\u5EFA\\u7684\\u7C7B\\u3002\\u8FD9\\u6837\\u5BF9\\u8C61\\u5C31\\u53D8\\u6210\\u4E86\\u65B0\\u521B\\u5EFA\\u7684\\u5B50\\u7C7B\\u7684\\u5B9E\\u4F8B\\u4E86\\u3002\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u53C2\\u8003 Mike Ash \\u7684 \",(0,n.jsx)(e.a,{href:\"https://www.mikeash.com/pyblog/friday-qa-2009-01-23.html\",children:\"Friday Q&A 2009-01-23\"}),\"\\u3002\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://github.com/mjyi/blogdemos/tree/master/kvo\",children:\"\\u6D4B\\u8BD5\\u4EE3\\u7801\\u5730\\u5740\"})}),`\n`,(0,n.jsxs)(e.h3,{id:\"kvo-\\u7684\\u7F3A\\u70B9\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#kvo-\\u7684\\u7F3A\\u70B9\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"KVO \\u7684\\u7F3A\\u70B9\"]}),`\n`,(0,n.jsx)(e.p,{children:`KVO\\u7684\\u7F3A\\u70B9\\u5728\\u4E8E\\u5B83\\u7684API\\uFF0C\\u6211\\u4EEC\\u53EA\\u80FD\\u901A\\u8FC7\nobserveValueForKeyPath: ofObject: change: context: \\u6765\\u83B7\\u5F97\\u901A\\u77E5\\u3002\\u65E0\\u6CD5\\u901A\\u8FC7\\u81EA\\u5B9A\\u4E49 selector \\u6216 block \\u6765\\u5904\\u7406\\u901A\\u77E5\\u4E8B\\u4EF6\\u3002\\u56E0\\u6B64\\u6211\\u4EEC\\u53EF\\u80FD\\u9700\\u8981\\u4E00\\u4E9B\\u5224\\u65AD\\u6765\\u5904\\u7406\\u4E0D\\u540C\\u7684\\u60C5\\u51B5\\u3002`}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5728\\u4E86\\u89E3\\u4E86kov\\u7684\\u5B9E\\u73B0\\u673A\\u5236\\u540E\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u4F7F\\u7528block\\u5B9E\\u73B0KVO.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u53C2\\u8003\\uFF1A\",(0,n.jsx)(e.a,{href:\"https://knightsj.github.io/2017/05/15/%E4%BD%BF%E7%94%A8Block%E5%AE%9E%E7%8E%B0KVO/\",children:\"\\u4F7F\\u7528Block\\u5B9E\\u73B0KVO\"}),` \\u3001\n`,(0,n.jsx)(e.a,{href:\"http://tech.glowing.com/cn/implement-kvo/\",children:\"\\u5982\\u4F55\\u81EA\\u5DF1\\u52A8\\u624B\\u5B9E\\u73B0 KVO\"})]}),`\n`,(0,n.jsxs)(e.h3,{id:\"kvocontroller\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#kvocontroller\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"KVOController\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/facebook/KVOController\",children:\"KVOController\"}),\"\\u662FFacebook \\u63A8\\u51FA\\u7684\\u4E00\\u4E2A\\u5F00\\u6E90\\u5E93\\u3002\\u5B83\\u662F\\u57FA\\u4E8E Cocoa \\u7684KVO \\u7684\\u4E00\\u6B21\\u5C01\\u88C5\\uFF0C\\u63D0\\u4F9B\\u7B80\\u5355\\u7684API\\uFF0C\\u5E76\\u4E14\\u662F\\u7EBF\\u7A0B\\u5B89\\u5168\\u7684\\u3002\"]}),`\n`,(0,n.jsx)(e.p,{children:\"\\u4F7F\\u7528\\u65B9\\u6CD5\\uFF1A\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-objectivec\",children:(0,n.jsxs)(e.code,{className:\"language-objectivec code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// create KVO controller with observer\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"FBKVOController \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"KVOController \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"FBKVOController controllerWithObserver\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"KVOController \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" KVOController\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// observe clock date property\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"KVOController observe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"clock keyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'@\"date\"'}),\" options\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"NSKeyValueObservingOptionInitial\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),\"NSKeyValueObservingOptionNew block\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"^\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ClockView \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"clockView\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" Clock \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"clock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" NSDictionary \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"change\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// update clock view with new value\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  clockView\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"date \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" change\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"NSKeyValueChangeNewKey\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:`\\u5728\\u4F7F\\u7528 KVOController\\u65F6\\uFF0C\\u6211\\u4EEC\\u4E0D\\u9700\\u8981\\u5173\\u6CE8\\u5728\\u4F55\\u65F6\\u79FB\\u9664\\u89C2\\u5BDF\\u8005\\uFF0C\\u56E0\\u4E3AKVOController\\u4F1A\\u5728dealloc\\u65F6\\u81EA\\u52A8\\u5C06\\u5176\\u79FB\\u9664\\u3002\n\\u4F7F\\u7528 block \\u6765\\u5904\\u7406KVO\\u7684\\u901A\\u77E5\\u4E8B\\u4EF6\\uFF0C\\u66F4\\u662F\\u4E00\\u79CD\\u7F8E\\u597D\\u7684\\u4F53\\u9A8C\\u3002`}),`\n`,(0,n.jsxs)(e.h4,{id:\"\\u9879\\u76EE\\u7ED3\\u6784\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u9879\\u76EE\\u7ED3\\u6784\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u9879\\u76EE\\u7ED3\\u6784\"]}),`\n`,(0,n.jsx)(e.p,{children:\"KVOController \\u6574\\u4E2A\\u9879\\u76EE\\u7ED3\\u6784\\u53EA\\u80FD\\u67095\\u4E2A\\u6587\\u4EF6\\uFF1A\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-objectivec\",children:(0,n.jsxs)(e.code,{className:\"language-objectivec code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\\u251C\\u2500\\u2500 KVOController\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`h\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\\u251C\\u2500\\u2500 FBKVOController\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`h\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\\u251C\\u2500\\u2500 FBKVOController\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`m\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\\u251C\\u2500\\u2500 NSObject\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\"FBKVOController\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`h\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\\u2514\\u2500\\u2500 NSObject\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\"FBKVOController\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`m\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5176\\u4E2D\\uFF0CKVOController.h \\u662F\\u5934\\u6587\\u4EF6\\uFF0CNSObject+FBKVOController \\u901A\\u8FC7 AssociateObject \\u4E3A NSObject \\u63D0\\u4F9B\\u4E00\\u4E2A retain \\u548C \\u975Eretain \\u7C7B\\u578B\\u7684KVOController\\u3002 FBKVOController\\u6587\\u4EF6\\u5C31\\u662F\\u4E3B\\u8981\\u7684\\u6280\\u672F\\u5B9E\\u73B0\\u3002\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5728 FBKVOController \\u6587\\u4EF6\\u4E2D\\u4E3B\\u8981\\u5B9A\\u4E49\\u4E86\\u4E09\\u4E2A\\u7C7B\\uFF1A\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"_FBKVOInfo\"}),`\n`,(0,n.jsx)(e.li,{children:\"_FBKVOSharedController\"}),`\n`,(0,n.jsx)(e.li,{children:\"_KVOController\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h4,{id:\"fbkvocontroller\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#fbkvocontroller\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"FBKVOController\"]}),`\n`,(0,n.jsx)(e.p,{children:\"\\u6210\\u5458\\u53D8\\u91CF\\u4EE5\\u53CA\\u521D\\u59CB\\u5316\\u65B9\\u6CD5\\uFF1A\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-objectivec\",children:(0,n.jsxs)(e.code,{className:\"language-objectivec code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:`/**\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token comment\",children:` The observer notified on key-value change. Specified on initialization.\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\" */\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"@property\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nullable\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" nonatomic\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" weak\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" readonly\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" id observer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"@implementation\"}),` FBKVOController\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  NSMapTable\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" NSMutableSet\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"_FBKVOInfo \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"_objectInfosMap\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  pthread_mutex_t _lock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"instancetype\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"initWithObserver\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nullable id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"observer retainObserved\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"BOOL\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`retainObserved\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"super\"}),\" init\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nil \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    _observer \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" observer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    NSPointerFunctionsOptions keyOptions \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" retainObserved \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"?\"}),\" NSPointerFunctionsStrongMemory\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),\"NSPointerFunctionsObjectPointerPersonality \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" NSPointerFunctionsWeakMemory\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),\"NSPointerFunctionsObjectPointerPersonality\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    _objectInfosMap \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"NSMapTable alloc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" initWithKeyOptions\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"keyOptions valueOptions\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"NSPointerFunctionsStrongMemory\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),\"NSPointerFunctionsObjectPersonality capacity\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"pthread_mutex_init\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"_lock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"KVOController \\u7EF4\\u62A4\\u4E86\\u4E00\\u4E2A\\u5BF9\\u89C2\\u5BDF\\u8005\\u7684\\u5F31\\u5F15\\u7528,\\u5728\\u521D\\u59CB\\u5316\\u65F6\\uFF0C\\u4F20\\u5165\\u7684observer\\u8D4B\\u503C\\u7ED9_observer\\u8FDB\\u884Cweak\\u6301\\u6709\\u3002\"}),`\n`]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"NSMapTable, \\u548CNSDictionary \\u7C7B\\u4F3C\\uFF0C\\u4F46\\u662F\\u662F\\u4E00\\u4E2Aobject-object\\u7684\\u6620\\u5C04\\u5173\\u7CFB\\uFF0C\\u5E76\\u4E14\\u53EF\\u4EE5\\u6307\\u5B9A key\\u3001value\\u7684strong\\uFF0Cweak \\u6216\\u8005 copy \\u7C7B\\u578B\\u3002\\u901A\\u8FC7retainObserved\\u53C2\\u6570\\u6765\\u751F\\u6210\\u5BF9\\u5E94\\u7684weak\\u6216\\u8005strong\\u7684NSPointerFunctionsOptions\"}),`\n`,(0,n.jsx)(e.li,{children:\"_lock \\u4E92\\u65A5\\u9501\\uFF0C\\u4FDD\\u8BC1\\u7EBF\\u7A0B\\u5B89\\u5168\\u3002\"}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"FBKVOController\\u5BF9\\u89C2\\u5BDF\\u5BF9\\u8C61 add Observer\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-objectivec\",children:(0,n.jsxs)(e.code,{className:\"language-objectivec code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"observe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nullable id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"object keyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"NSString \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"keyPath options\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"NSKeyValueObservingOptions\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"options block\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"FBKVONotificationBlock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`block\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"NSAssert\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" keyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"length \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"NULL\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" block\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'@\"missing required parameters observe:%@ keyPath:%@ block:%p\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" object\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" keyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" block\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nil \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" object \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"||\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" keyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"length \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"||\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"NULL\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" block\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// create info\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  _FBKVOInfo \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"info \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"_FBKVOInfo alloc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" initWithController\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),\" keyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"keyPath options\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"options block\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"block\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// observe object with info\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),\" _observe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"object info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"_observe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"object info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"_FBKVOInfo \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`info\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// lock\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"pthread_mutex_lock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"_lock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  NSMutableSet \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"infos \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"_objectInfosMap objectForKey\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"object\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// check for info existence\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  _FBKVOInfo \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"existingInfo \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"infos member\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nil \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" existingInfo\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// observation info already exists; do not observe it again\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// unlock and return\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"pthread_mutex_unlock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"_lock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// lazilly create set of infos\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nil \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" infos\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    infos \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"NSMutableSet set\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"_objectInfosMap setObject\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"infos forKey\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"object\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// add info and oberve\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"infos addObject\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// unlock prior to callout\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"pthread_mutex_unlock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"_lock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"_FBKVOSharedController sharedController\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" observe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"object info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u4EE3\\u7801\\u4E2D\\u5BF9\\u4E8E\\u5B9E\\u73B0\\u601D\\u8DEF\\u505A\\u4E86\\u5F88\\u597D\\u7684\\u6CE8\\u91CA\\uFF1A\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"\\u9996\\u5148\\u5BF9\\u4E8E\\u4F20\\u5165\\u7684\\u64CD\\u4F5C\\u8FDB\\u884C\\u65AD\\u8A00\\u5224\\u65AD\\u3002\"}),`\n`]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"\\u4F7F\\u7528\\u4F20\\u5165\\u53C2\\u6570\\u521B\\u5EFA _FBKVOInfo \\u5B9E\\u4F8B info\\u3002\\u5BF9info \\u6DFB\\u52A0\\u89C2\\u5BDF[self _observe:object info:info];\\u3002\"}),`\n`,(0,n.jsx)(e.li,{children:\"\\u5BF9_objectInfosMap \\u8FDB\\u884C\\u68C0\\u67E5\\uFF0C\\u907F\\u514D\\u91CD\\u590D\\u6DFB\\u52A0\\u3002\\u5E76\\u5728\\u8BFB\\u5199\\u65F6\\u4F7F\\u7528\\u52A0\\u9501\\uFF0C\\u4FDD\\u8BC1\\u7EBF\\u7A0B\\u5B89\\u5168\\u3002\"}),`\n`,(0,n.jsx)(e.li,{children:\"\\u6DFB\\u52A0\\u6210\\u529F\\u540E\\u8C03\\u7528 [[_FBKVOSharedController sharedController] observe:object info:info]\"}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5B9E\\u73B0\\u9690\\u5F0F\\u5730\\u79FB\\u9664KVO\\uFF1A\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-objectivec\",children:(0,n.jsxs)(e.code,{className:\"language-objectivec code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`dealloc\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),\" unobserveAll\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"pthread_mutex_destroy\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"_lock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`_unobserveAll\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// lock\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"pthread_mutex_lock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"_lock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  NSMapTable \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"objectInfoMaps \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"_objectInfosMap copy\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// clear table and map\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"_objectInfosMap removeAllObjects\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// unlock\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"pthread_mutex_unlock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"_lock\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  _FBKVOSharedController \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"shareController \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"_FBKVOSharedController sharedController\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"id object \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"in\"}),\" objectInfoMaps\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// unobserve each registered object and infos\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    NSSet \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"infos \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"objectInfoMaps objectForKey\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"object\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"shareController unobserve\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"object infos\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"infos\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5728 KVOController \\u91CA\\u653E\\u7684\\u65F6\\u5019\\uFF0C\\u4ECE_FBKVOSharedController\\u5355\\u4F8B\\u4E2D\\u79FB\\u9664 observer\"}),`\n`,(0,n.jsxs)(e.h4,{id:\"_fbkvosharedcontroller\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#_fbkvosharedcontroller\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"_FBKVOSharedController\"]}),`\n`,(0,n.jsx)(e.p,{children:\"_FBKVOSharedController \\u88AB\\u8BBE\\u8BA1\\u6210\\u5355\\u4F8B\\uFF0C\\u7EDF\\u4E00\\u7BA1\\u7406KVO\\u901A\\u77E5\\u7684\\u63A5\\u6536\\u548C\\u8F6C\\u53D1\\u3002\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-objectivec\",children:(0,n.jsxs)(e.code,{className:\"language-objectivec code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"@implementation\"}),` _FBKVOSharedController\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  NSHashTable\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"_FBKVOInfo \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"_infos\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  pthread_mutex_t _mutex\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"_infos:  NSHashTable\\u7C7B\\u578B\\uFF0C\\u7C7B\\u4F3CNSSet\\uFF0C\\u540C\\u6837\\u4E5F\\u53EF\\u4EE5\\u8BBE\\u7F6E\\u5BF9\\u8C61\\u7684\\u5F3A\\u5F31\\u5F15\\u7528\\u3002\"}),`\n`,(0,n.jsx)(e.li,{children:\"_mutex\\uFF1A \\u4E92\\u65A5\\u9501\\uFF0C\\u4E3A\\u4E86\\u7EBF\\u7A0B\\u5B89\\u5168\\u3002\"}),`\n`]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-objectivec\",children:(0,n.jsxs)(e.code,{className:\"language-objectivec code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"observe\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"object info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nullable _FBKVOInfo \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`info\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nil \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// register info\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"pthread_mutex_lock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"_mutex\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"_infos addObject\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"pthread_mutex_unlock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"_mutex\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// add observer\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"object addObserver\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),\" forKeyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_keyPath options\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_options context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_state \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" _FBKVOInfoStateInitial\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_state \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" _FBKVOInfoStateObserving\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_state \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" _FBKVOInfoStateNotObserving\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"object removeObserver\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),\" forKeyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_keyPath context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"\\u5C06 info \\u52A0\\u5165 _infos.\"}),`\n`,(0,n.jsx)(e.li,{children:\"[object addObserver:self forKeyPath:info->_keyPath options:info->_options context:(void *)info] \\u4E3Aobject \\u6DFB\\u52A0\\u89C2\\u5BDF\\u8005\\u3002\"}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5728 _FBKVOSharedController \\u5B9E\\u73B0observeValueForKeyPath:ofObject:Change:context \\u63A5\\u6536\\u5904\\u7406\\u901A\\u77E5\\u3002\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"info = [_infos member:(__bridge id)context];\"}),`\n\\u5728 _infos \\u4E2D\\u627E\\u5230\\u5F53\\u524D _FBKVOInfo,\\u5E76\\u5BF9\\u5B83\\u8FDB\\u884C\\u4E00\\u4E2A\\u5F3A\\u5F15\\u7528\\u3002\\u5BF9\\u6570\\u636E\\u8FDB\\u884C\\u5C01\\u88C5\\uFF0C\\u6267\\u884C\\u6CE8\\u518C\\u7684\\u56DE\\u8C03\\u3002block\\uFF0C selector, \\u9ED8\\u8BA4\\u65B9\\u6CD5\\u3002`]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-objectivec\",children:(0,n.jsxs)(e.code,{className:\"language-objectivec code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nil \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// take strong reference to controller\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    FBKVOController \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"controller \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_controller\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nil \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" controller\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// take strong reference to observer\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      id observer \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" controller\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"observer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nil \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" observer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// dispatch custom block or action, fall back to default action\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_block\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          NSDictionary\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"NSKeyValueChangeKey\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" id\",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"changeWithKeyPath \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" change\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// add the keyPath to the change dictionary for clarity when mulitple keyPaths are being observed\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"keyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            NSMutableDictionary\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\"NSString \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" id\",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"mChange \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"NSMutableDictionary dictionaryWithObject\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"keyPath forKey\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"FBKVONotificationKeyPathKey\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"mChange addEntriesFromDictionary\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"change\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            changeWithKeyPath \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"mChange copy\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"_block\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"observer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" object\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" changeWithKeyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_action\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token directive keyword\",children:\"pragma\"}),\" \",(0,n.jsx)(e.span,{className:\"token expression\",children:\"clang diagnostic push\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token directive keyword\",children:\"pragma\"}),\" \",(0,n.jsx)(e.span,{className:\"token expression\",children:\"clang diagnostic ignored \"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"-Warc-performSelector-leaks\"'})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"observer performSelector\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_action withObject\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"change withObject\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"object\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token directive keyword\",children:\"pragma\"}),\" \",(0,n.jsx)(e.span,{className:\"token expression\",children:\"clang diagnostic pop\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"observer observeValueForKeyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"keyPath ofObject\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"object change\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"change context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"unobserve\"}),\" ,\\u5728KVOController \",(0,n.jsx)(e.em,{children:\"dealloc()\"}),\" \\u65F6\\u4F1A\\u5C06 info \\u4ECE _infos\\u4E2D\\u79FB\\u9664\\uFF0C\\u5E76\\u7528\\u79FB\\u9664\\u89C2\\u5BDF\\u8005 \\uFF0C\\u4ECE\\u800C\\u5B9E\\u73B0\\u9690\\u5F0F\\u5730\\u79FB\\u9664KVO\\u3002\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-objectivec\",children:(0,n.jsxs)(e.code,{className:\"language-objectivec code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"unobserve\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"object info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nullable _FBKVOInfo \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`info\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"nil \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// unregister info\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"pthread_mutex_lock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"_mutex\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"_infos removeObject\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"pthread_mutex_unlock\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"_mutex\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// remove observer\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_state \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" _FBKVOInfoStateObserving\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"object removeObserver\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"self\"}),\" forKeyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_keyPath context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\"info\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  info\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"->\"}),\"_state \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" _FBKVOInfoStateNotObserving\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.h4,{id:\"_fbkvoinfo\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#_fbkvoinfo\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"_FBKVOInfo\"]}),`\n`,(0,n.jsx)(e.p,{children:\"_FBKVOInfo \\u5C06 \\u5C06\\u89C2\\u5BDF\\u8005\\u4FE1\\u606F\\u4FDD\\u5B58\\u5728\\u4E00\\u8D77\\uFF0C\\u5E76\\u4E14\\u91CD\\u5199\\u4E86 hash \\u548C isEqual\\uFF0C\\u4EE5 _keyPath\\u4F5C\\u4E3A\\u552F\\u4E00\\u6027\\u5224\\u65AD\\u4F9D\\u636E\\u3002\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-objectivec\",children:(0,n.jsxs)(e.code,{className:\"language-objectivec code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"@implementation\"}),` _FBKVOInfo\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"@public\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  __weak FBKVOController \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"_controller\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  NSString \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"_keyPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  NSKeyValueObservingOptions _options\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  SEL _action\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"_context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  FBKVONotificationBlock _block\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  _FBKVOInfoState _state\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.h3,{id:\"reference\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#reference\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Reference\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://github.com/facebook/KVOController\",children:\"KVOController\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"http://draveness.me/kvocontroller.html\",children:\"\\u5982\\u4F55\\u4F18\\u96C5\\u5730\\u4F7F\\u7528KVO\"})}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"[EOF]\"})]})}}var _=y;return g(v);})();\n;return Component;"},"isPost":true,"seoImage":{"url":"https://fninit.com/site-meta.png","dimensions":{"width":1120,"height":768}},"previewPosts":[],"prevPost":{"slug":"/posts/2017/linux-vimrc","title":"关于Vim不能正常显示中文的解决方法","date":"2017-07-10T02:04:03.000Z","excerpt":null,"draft":false,"page":false,"comment":true,"featureImage":{"url":"/images/altumcode-unsplash.webp","dimensions":{"width":1858,"height":1308}},"toc":null,"tags":[{"name":"linux","slug":"linux"},{"name":"vim","slug":"vim"}],"authors":[{"slug":"roninro","name":"Roninro","cover_image":"/images/publication-cover.png","profileImage":{"url":"/images/avatar.jpg","dimensions":{"width":1080,"height":1080}},"location":"THE INTERNET","bio":"Software Development Engineer","twitter":"@xxxxx","facebook":"xxxxxx"}],"primary_tag":{"name":"linux","slug":"linux"},"reading_time":"1 min read"},"nextPost":{"slug":"/posts/2017/ios-carthage","title":"Carthage 的简单使用","date":"2017-06-19T12:57:37.000Z","excerpt":null,"draft":false,"page":false,"comment":true,"featureImage":{"url":"/images/dNjMqj4emkc-unsplash.jpg","dimensions":{"width":2000,"height":1333}},"toc":null,"tags":[{"name":"iOS","slug":"ios"}],"authors":[{"slug":"roninro","name":"Roninro","cover_image":"/images/publication-cover.png","profileImage":{"url":"/images/avatar.jpg","dimensions":{"width":1080,"height":1080}},"location":"THE INTERNET","bio":"Software Development Engineer","twitter":"@xxxxx","facebook":"xxxxxx"}],"primary_tag":{"name":"iOS","slug":"ios"},"reading_time":"2 min read"},"bodyClass":"post-template tag-kvocontroller tag-ios"}},"__N_SSG":true}